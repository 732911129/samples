if [[ $# -lt 2 || $# -gt 3 ]]; then
  echo "Usage: $0 [ zipfile ] [ task-guid ] [ -q ]"
  echo "-q suppresses all prompts and assumes yes answer."
  exit 1
fi

zip=$1
guid=$2
shift
args="$@"
staging=~/.jar.io/tmp/build_staging/$guid

if [[ ! -e $staging ]]; then
  echo "Making $staging directory..."
  mkdir -p $staging
elif [[ ! -d $staging ]]; then
  echo "$staging exists but is not a directory" 1>&2
  exit 1
else
  echo "Clearing $staging directory..."
  rm -rf $staging/*
fi

# check if the quiet option is set
if [[ ! $@ == *-q* ]]; then
  while true; do
    read -p "Unzip $zip into $staging? ( y/n ) " yn
    case $yn in
      [Yy]* ) unzip $zip -d $staging; break;;
      [Nn]* ) exit;;
      * ) echo "Please answer yes or no.";;
    esac
  done
else
  echo "Unzipping $zip into $staging..."
  unzip $zip -d $staging
fi

