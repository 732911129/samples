var PAN_ACTION_DIRECTIVE = 'pan-do';function execute(fun_name) {	var fun_rule;	var card = chrome.app.window.current();	if(fun_name[0] == '{') {		fun_rule = JSON.parse(fun_name).rule;		var test_result = card[fun_rule.test]();		fun_name = fun_rule.iftest[test_result];	}			var fun = card[fun_name];	if(!!fun && fun instanceof Function) {		console.log("Executing, ", fun_name, " on the application window.");		var executable = fun.bind(card);		executable();	} else {		console.error("Can not execute ", fun_name, " on the application window.");	}}function bind(selector, action, handler) {	var elems = selector instanceof Node ? [selector] : document.querySelectorAll(selector);	var elemlen = elems.length;	for(var i=0;i < elemlen;i++) {		var elemi = elems[i];		console.log("Binding ", handler, " on ", action , " to ", elemi);		elemi.addEventListener(action,handler);	}}function control_window(event) {	console.log("Received window event", event);	var bound_elem = event.currentTarget;	var action = bound_elem.getAttribute(PAN_ACTION_DIRECTIVE);	execute(action);	}function setup_window_control() {	console.log("Setting up window control");	bind('button.control-button','click',control_window);}bind(document,"DOMContentLoaded",setup_window_control);